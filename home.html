<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LibraryEase - Library Management System</title>
    <style>
       /* Reset and Base Styles */
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
}

body {
    background-color: #f5f7fa;
    color: #333;
    line-height: 1.6;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
}

a {
    text-decoration: none;
    color: inherit;
    transition: color 0.3s ease;
}

 /* Header Styles */
        /* header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: bold;
        }

        .nav-links {
            display: flex;
            gap: 2rem;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .nav-links a:hover,
        .nav-links a.active {
            background-color: rgba(255,255,255,0.2);
        } */

 /*Header Styles*/
 header {
    background-color: #1a237e;
    color: white;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    position: sticky;
    top: 0;
    z-index: 100;
}

nav {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px;
    max-width: 1200px;
    margin: 0 auto;
}

.logo {
    font-size: 1.8rem;
    font-weight: 700;
    color: white;
    letter-spacing: 0.5px;
}

.nav-links {
    display: flex;
    gap: 20px;
}

.nav-links a {
    color: rgba(255, 255, 255, 0.8);
    font-weight: 500;
    padding: 8px 12px;
    border-radius: 4px;
}

.nav-links a:hover {
    color: white;
    background-color: rgba(255, 255, 255, 0.1);
}

.nav-links a.active {
    color: white;
    border-bottom: 3px solid #64b5f6;
} 



/* Hero Section*/
.hero {
    /* background:linear-gradient(135deg, #f093fb 0%, #764ba2 100% ); */
        

    background: linear-gradient(135deg, #283593 0%, #1976d2 100%); 
    color: white;
    padding: 80px 20px;
    text-align: center;
}

.hero-content {
    max-width: 800px;
    margin: 0 auto;
}

.hero h1 {
    font-size: 2.5rem;
    margin-bottom: 16px;
    font-weight: 700;
}

.hero p {
    font-size: 1.2rem;
    opacity: 0.9;
    margin-bottom: 24px;
} 



/* Search Section */
.search-section {
    padding: 50px 0;
    background-color: white;
    border-bottom: 1px solid #e0e0e0;
}

.search-section h2 {
    text-align: center;
    margin-bottom: 30px;
    color: #1a237e;
    font-size: 1.8rem;
}

.search-container {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    max-width: 800px;
    margin: 0 auto;
}

#search-input {
    flex: 1;
    padding: 12px 20px;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

#search-input:focus {
    outline: none;
    border-color: #1976d2;
}

.btn {
    background-color: #1976d2;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    font-size: 1rem;
    font-weight: 500;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

.btn:hover {
    background-color: #1565c0;
}

.search-results-container {
    margin-top: 30px;
    
}

/* Quick Links Section */
/* .quick-links {
    padding: 60px 0;
    background-color: #f5f7fa;
}

.quick-links h2 {
    text-align: center;
    margin-bottom: 40px;
    color: #1a237e;
    font-size: 1.8rem;
}

.links-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
    max-width: 1200px;
    margin: 0 auto;
}

.link-card {
    background-color: white;
    border-radius: 12px;
    padding: 30px 20px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}

.link-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
}

.link-card .icon {
    font-size: 2.5rem;
    margin-bottom: 15px;
}

.link-card h3 {
    color: #1a237e;
    margin-bottom: 10px;
    font-size: 1.3rem;
}

.link-card p {
    color: #666;
    font-size: 0.9rem;
} */

/* Footer */
footer {
    background-color: #1a237e;
    color: white;
    padding-top: 50px;
}

.footer-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 40px;
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px 40px;
}

.footer-section h3 {
    color: white;
    margin-bottom: 20px;
    font-size: 1.3rem;
    position: relative;
    display: inline-block;
}

.footer-section h3:after {
    content: '';
    display: block;
    width: 50px;
    height: 2px;
    background-color: #64b5f6;
    margin-top: 8px;
}

.footer-section p {
    color: rgba(255, 255, 255, 0.7);
    line-height: 1.7;
}

.footer-links {
    list-style: none;
}

.footer-links li {
    margin-bottom: 12px;
}

.footer-links a {
    color: rgba(255, 255, 255, 0.7);
    transition: color 0.3s ease;
}

.footer-links a:hover {
    color: white;
}

.footer-bottom {
    text-align: center;
    padding: 20px 0;
    border-top: 1px solid rgba(255, 255, 255, 0.1);
    background-color: rgba(0, 0, 0, 0.2);
    font-size: 0.9rem;
    color: rgba(255, 255, 255, 0.6);
}

/* Responsive Design */
@media (max-width: 768px) {
    nav {
        flex-direction: column;
        gap: 15px;
        padding: 15px;
    }
    
    .nav-links {
        width: 100%;
        justify-content: center;
        flex-wrap: wrap;
    }
    
    .hero h1 {
        font-size: 2rem;
    }
    
    .hero p {
        font-size: 1rem;
    }
    
    .search-container {
        flex-direction: column;
    }
    
    .btn {
        width: 100%;
    }
}

@media (max-width: 480px) {
    .hero {
        padding: 60px 15px;
    }
    
    .links-grid {
        grid-template-columns: 1fr;
    }
    
    .footer-container {
        grid-template-columns: 1fr;
    }
}















         /* .content {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            margin: -50px auto 40px;
            padding: 60px;
            position: relative;
            z-index: 10;
            backdrop-filter: blur(10px);
        }

        .section {
            margin-bottom: 50px;
            opacity: 0;
            transform: translateY(30px);
            transition: all 0.6s ease-out;
        }

        .section.visible {
            opacity: 1;
            transform: translateY(0);
        }

        .section h2 {
            font-size: 2.5rem;
            color: #4a5568;
            margin-bottom: 25px;
            position: relative;
            display: inline-block;
        }

        .section h2::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 60px;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        .section h2:hover::after {
            width: 100px;
        }

        .section p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 20px;
            text-align: justify;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .feature-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            padding: 30px;
            border-radius: 15px;
            color: white;
            text-align: center;
            transform: translateY(0);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 30px rgba(240, 147, 251, 0.4);
        }

        .feature-card:nth-child(2) {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        .feature-card:nth-child(3) {
            background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
        }

        .feature-card:nth-child(4) {
            background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .feature-card h3 {
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .team-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 60px;
            border-radius: 20px;
            margin: 40px 0;
            text-align: center;
        }

        .team-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .team-member {
            background: rgba(255, 255, 255, 0.1);
            padding: 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
        }

        .team-member:hover {
            transform: scale(1.05);
            background: rgba(255, 255, 255, 0.2);
        }

        .team-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(45deg, #f093fb, #f5576c);
            margin: 0 auto 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }

        .stats-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin: 50px 0;
        }

        .stat-card {
            text-align: center;
            padding: 30px;
            border-radius: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: scale(1);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: scale(1.05);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
            counter-reset: num;
            animation: countUp 2s ease-out;
        }

        .contact-section {
            background: #f8f9fa;
            padding: 50px;
            border-radius: 15px;
            margin-top: 40px;
        }

        .contact-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 30px;
        }

        .contact-item {
            text-align: center;
            padding: 20px;
        }

        .contact-icon {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 15px;
        }

        .btn {
            display: inline-block;
            padding: 15px 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 50px;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 20px 10px;
            border: none;
            cursor: pointer;
            font-size: 1rem;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }

        .floating-shapes {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .shape {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            animation: float 6s ease-in-out infinite;
        }

        .shape:nth-child(1) {
            width: 80px;
            height: 80px;
            top: 20%;
            left: 10%;
            animation-delay: 0s;
        }

        .shape:nth-child(2) {
            width: 120px;
            height: 120px;
            top: 60%;
            right: 10%;
            animation-delay: 2s;
        }

        .shape:nth-child(3) {
            width: 60px;
            height: 60px;
            bottom: 20%;
            left: 20%;
            animation-delay: 4s;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            33% { transform: translateY(-20px) rotate(120deg); }
            66% { transform: translateY(10px) rotate(240deg); }
        }

        @keyframes countUp {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }
            
            .content {
                padding: 30px;
                margin: -30px 20px 20px;
            }
            
            .section h2 {
                font-size: 2rem;
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        } */


     </style> 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header>
        <nav>
            <div class="logo">LibraryEase</div>
            <div class="nav-links">
                <a href="home.html" class="active">Home</a>
                <a href="catalog7.html">Books</a>
                <a href="dashboard.html">Dashboard</a>
                <a href="logout.html">Logout</a>
                <a href="login.html">Login</a>

            </div>
        </nav>
    </header>
    
    <!-- Main Content -->
    <main>
        <section class="hero">
            <div class="hero-content">
                <h1>Welcome to the Library Management System</h1>
                <p>Find, borrow, and manage books with ease.</p>
           
        

        <!-- Search Section -->
        <section class="search-section">
            <div class="container">
                <h2>Find Books</h2>
                <div class="search-container">
                    <input type="text" id="search-input" placeholder="Search by title, author, or ISBN...">
                    <button id="search-btn" class="btn">Search</button>
                </div>
                
                <!-- Search Results will appear here -->
                <div id="search-results" class="search-results-container"></div>
            </div>
            </section>
         </section>
        <!-- Quick Links -->
        <!-- <section class="quick-links">
            <div class="container">
                <h2>Quick Links</h2>
                <div class="links-grid">
                    <a href="catalog.html" class="link-card" >
                        <div class="icon">📚</div>
                        <h3>Browse Catalog</h3>
                        <p>View all books in our collection</p>
                    </a>
                    <a href="#" class="link-card">
                        <div class="icon">👤</div>
                        <h3>Member Area</h3>
                        <p>View your borrowed books and history</p>
                    </a>
                    <a href="#" class="link-card">
                        <div class="icon">🔍</div>
                        <h3>Advanced Search</h3>
                        <p>Search with more filters and options</p>
                    </a>
                    <a href="#" class="link-card">
                        <div class="icon">📊</div>
                        <h3>Analytics</h3>
                        <p>View library statistics and reports</p>
                    </a>
                </div>
            </div>
        </section>
    </main> -->

     
            <!--<div class="team-section">
                <h2>Our Development Team</h2>
                <p>Meet the talented individuals behind this innovative library management solution</p>
                <div class="team-grid">
                    <div class="team-member">
                        <div class="team-avatar">👨‍💻</div>
                        <h3>Alex Johnson</h3>
                        <p>Lead Developer</p>
                        <p>Full-stack developer with expertise in web technologies and database design.</p>
                    </div>
                    <div class="team-member">
                        <div class="team-avatar">👩‍🎨</div>
                        <h3>Sarah Chen</h3>
                        <p>UI/UX Designer</p>
                        <p>Creative designer focused on user experience and interface optimization.</p>
                    </div>
                    <div class="team-member">
                        <div class="team-avatar">👨‍💼</div>
                        <h3>Michael Brown</h3>
                        <p>Project Manager</p>
                        <p>Experienced project manager ensuring timely delivery and quality assurance.</p>
                    </div>
                </div>
            </div>-->

           

            <!-- <div class="contact-section">
                <h2 style="text-align: center; color: #4a5568; margin-bottom: 40px;">Get In Touch</h2>
                <div class="contact-grid">
                    <div class="contact-item">
                        <div class="contact-icon">📧</div>
                        <h3>Email</h3>
                        <p>support@libraryease.com</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">📞</div>
                        <h3>Phone</h3>
                        <p>+1 (555) 123-4567</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">🌐</div>
                        <h3>Website</h3>
                        <p>www.libraryease.com</p>
                    </div>
                </div>
                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn" onclick="showDemo()">Request Demo</button>
                    <button class="btn" onclick="showContact()">Contact Us</button>
                </div>
            </div>
        </main>
    </div>
     -->
    <!-- Footer -->
    <footer>
    
        <div class="footer-container">
            <div class="footer-section">
                <h3>About LibraryEase</h3>
                <p>A comprehensive library management system designed to streamline operations and enhance user experience.</p>
            </div>
            <div class="footer-section">
                <h3>Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="home.html">Home</a></li>
                    <li><a href="catalog.html">Catalog</a></li>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="help.html">Help & Support</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>Contact Us</h3>
                <ul class="footer-links">
                    <li><i class="fas fa-envelope"></i> support@libraryease.com</li>
                    <li><i class="fas fa-phone"></i> +1 (555) 123-4567</li>
                    <li><i class="fas fa-map-marker-alt"></i> 123 Library St, Bookville</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2025 LibraryEase. All rights reserved.</p>
        </div>
    </footer>
        
    <!-- JavaScript -->
     
    <script>
// Global variables
let books = [];
let filteredBooks = [];
let statistics = {
    totalBooks: 0,
    availableBooks: 0,
    borrowedBooks: 0,
    categories: {}
};

// DOM Content Loaded Event Listener
document.addEventListener('DOMContentLoaded', () => {
    console.log('DOM fully loaded');
    
    // Initialize the system
    initializeLibrarySystem();
    
    // Setup search functionality
    setupSearchFunctionality();
});

// Initialize the library system
function initializeLibrarySystem() {
    // Fetch books data
    fetchBooks();
}

// Setup search functionality
function setupSearchFunctionality() {
    const searchBtn = document.getElementById('search-btn');
    const searchInput = document.getElementById('search-input');
    
    if (searchBtn) {
        console.log('Adding click event to search button');
        searchBtn.addEventListener('click', performSearch);
    } else {
        console.error('Search button not found in the DOM');
    }
    
    if (searchInput) {
        console.log('Adding keypress event to search input');
        searchInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                performSearch();
            }
        });
    } else {
        console.error('Search input not found in the DOM');
    }
}

// Fetch books from db.json
function fetchBooks() {
    console.log('Fetching books from db.json');
    
    // Using fetch API to get books data
    fetch('db.json')
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Books data fetched successfully');
            
            // Store books data
            books = data.books || [];
            filteredBooks = [...books]; // Initialize filtered books with all books
            
            // Get any borrowed books from localStorage (only for status updates)
            const borrowedBooks = JSON.parse(localStorage.getItem('borrowedBooks')) || [];
            
            // If we have borrowed books in localStorage, update their status
            if (borrowedBooks.length > 0) {
                books.forEach(book => {
                    const borrowedBook = borrowedBooks.find(b => b.id === book.id);
                    if (borrowedBook) {
                        book.status = 'borrowed';
                        book.borrowDate = borrowedBook.borrowDate;
                    }
                });
            }
            
            // Calculate statistics
            calculateStatistics();
            
            // Display books and statistics
            displayFeaturedBooks();
            showLibraryStatistics();
            
            // Create search results section (hidden initially)
            createSearchResultsSection();
        })
        .catch(error => {
            console.error('Error fetching books:', error);
            
            // Show error message to user
            showErrorMessage('Failed to load books data. Please try again later.');
        });
}

// Calculate library statistics
function calculateStatistics() {
    // Reset statistics
    statistics = {
        totalBooks: books.length,
        availableBooks: 0,
        borrowedBooks: 0,
        categories: {}
    };
    
    // Calculate statistics from books data
    books.forEach(book => {
        // Count by status
        if (book.status === 'available') {
            statistics.availableBooks++;
        } else if (book.status === 'borrowed') {
            statistics.borrowedBooks++;
        }
        
        // Count by category
        if (book.category) {
            if (!statistics.categories[book.category]) {
                statistics.categories[book.category] = 0;
            }
            statistics.categories[book.category]++;
        }
    });
}

// Display featured books on homepage
function displayFeaturedBooks() {
    // Check if featured books section exists
    let featuredBooksSection = document.querySelector('.featured-books');
    if (!featuredBooksSection) {
        // Create featured books section if it doesn't exist
        createFeaturedBooksSection();
    } else {
        // Update existing section
        updateFeaturedBooksSection();
    }
}

// Create featured books section
function createFeaturedBooksSection() {
    console.log('Creating featured books section');
    
    // Create featured books section
    const main = document.querySelector('main');
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'featured-books';
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Featured Books';
    container.appendChild(heading);
    
    // Create books grid
    const booksGrid = document.createElement('div');
    booksGrid.className = 'books-grid';
    booksGrid.id = 'featured-books-grid';
    booksGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Add featured books
    const featuredBooks = getFeaturedBooks();
    featuredBooks.forEach(book => {
        booksGrid.appendChild(createBookCard(book));
    });
    
    // Append elements
    container.appendChild(booksGrid);
    section.appendChild(container);
    
    // Insert after search section
    const searchSection = document.querySelector('.search-section');
    if (searchSection) {
        if (searchSection.nextElementSibling) {
            main.insertBefore(section, searchSection.nextElementSibling);
        } else {
            main.appendChild(section);
        }
    } else {
        // Insert before quick links as fallback
        const quickLinks = document.querySelector('.quick-links');
        if (quickLinks) {
            main.insertBefore(section, quickLinks);
        } else {
            main.appendChild(section);
        }
    }
}

// Create search results section
function createSearchResultsSection() {
    console.log('Creating search results section');
    
    // Get main element
    const main = document.querySelector('main');
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'search-results-section';
    section.id = 'search-results-section';
    section.style.display = 'none'; // Hide initially
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Search Results';
    heading.id = 'search-results-heading';
    container.appendChild(heading);
    
    // Create books grid for search results
    const booksGrid = document.createElement('div');
    booksGrid.className = 'books-grid';
    booksGrid.id = 'search-results-grid';
    booksGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Append elements
    container.appendChild(booksGrid);
    section.appendChild(container);
    
    // Insert after search section
    const searchSection = document.querySelector('.search-section');
    if (searchSection) {
        if (searchSection.nextElementSibling) {
            main.insertBefore(section, searchSection.nextElementSibling);
        } else {
            main.appendChild(section);
        }
    } else {
        // Fallback: insert at beginning of main
        if (main.firstChild) {
            main.insertBefore(section, main.firstChild);
        } else {
            main.appendChild(section);
        }
    }
}

// Update featured books section
function updateFeaturedBooksSection() {
    // Get featured books grid
    const featuredBooksGrid = document.getElementById('featured-books-grid');
    if (!featuredBooksGrid) return;
    
    // Clear existing content
    featuredBooksGrid.innerHTML = '';
    
    // Add featured books
    const featuredBooks = getFeaturedBooks();
    featuredBooks.forEach(book => {
        featuredBooksGrid.appendChild(createBookCard(book));
    });
}

// Get featured books
function getFeaturedBooks() {
    // Get up to 4 featured books
    return books
        .sort((a, b) => new Date(b.addedDate) - new Date(a.addedDate)) // Sort by added date (newest first)
        .slice(0, 4); // Take first 4
}

// Create book card element
function createBookCard(book) {
    // Create book card
    const card = document.createElement('div');
    card.className = 'book-card';
    card.dataset.id = book.id;
    
    // Add inline styles for book card
    card.style.cssText = `
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        overflow: hidden;
        background: white;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: transform 0.2s, box-shadow 0.2s;
        cursor: pointer;
    `;
    
    // Create card content
    const coverImg = document.createElement('img');
    coverImg.className = 'book-cover';
    coverImg.src = book.coverUrl || '/api/placeholder/250/300';
    coverImg.alt = `${book.title} cover`;
    coverImg.style.cssText = `
        width: 100%;
        height: 200px;
        object-fit: cover;
    `;
    
    const cardContent = document.createElement('div');
    cardContent.style.cssText = 'padding: 15px;';
    
    const title = document.createElement('h3');
    title.className = 'book-title';
    title.textContent = book.title;
    title.style.cssText = `
        margin: 0 0 8px 0;
        font-size: 16px;
        font-weight: 600;
        color: #2d3748;
        line-height: 1.3;
    `;
    
    const author = document.createElement('p');
    author.className = 'book-author';
    author.textContent = `by ${book.author}`;
    author.style.cssText = `
        margin: 0 0 8px 0;
        color: #718096;
        font-size: 14px;
    `;
    
    const category = document.createElement('p');
    category.className = 'book-category';
    category.textContent = book.category.charAt(0).toUpperCase() + book.category.slice(1);
    category.style.cssText = `
        margin: 0 0 12px 0;
        color: #4a5568;
        font-size: 12px;
        font-weight: 500;
    `;
    
    const status = document.createElement('span');
    status.className = `book-status ${book.status}`;
    status.textContent = book.status.charAt(0).toUpperCase() + book.status.slice(1);
    
    const statusColor = book.status === 'available' ? '#48bb78' : '#ed8936';
    status.style.cssText = `
        display: inline-block;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 11px;
        font-weight: 600;
        color: white;
        background-color: ${statusColor};
    `;
    
    const actionsDiv = document.createElement('div');
    actionsDiv.className = 'book-actions';
    actionsDiv.style.cssText = 'margin-top: 12px; display: flex; gap: 8px;';
    
    const viewBtn = document.createElement('button');
    viewBtn.textContent = 'View Details';
    viewBtn.className = 'btn btn-view';
    viewBtn.style.cssText = `
        flex: 1;
        padding: 6px 12px;
        border: 1px solid #4299e1;
        background: #4299e1;
        color: white;
        border-radius: 4px;
        font-size: 12px;
        cursor: pointer;
    `;
    
    const borrowBtn = document.createElement('button');
    if (book.status === 'available') {
        borrowBtn.textContent = 'Borrow';
        borrowBtn.className = 'btn btn-borrow';
        borrowBtn.style.cssText = `
            flex: 1;
            padding: 6px 12px;
            border: 1px solid #48bb78;
            background: #48bb78;
            color: white;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
        `;
        borrowBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            borrowBook(book.id);
        });
    } else {
        borrowBtn.textContent = 'Borrowed';
        borrowBtn.className = 'btn btn-borrowed';
        borrowBtn.disabled = true;
        borrowBtn.style.cssText = `
            flex: 1;
            padding: 6px 12px;
            border: 1px solid #a0aec0;
            background: #a0aec0;
            color: white;
            border-radius: 4px;
            font-size: 12px;
            cursor: not-allowed;
        `;
    }
    
    viewBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        viewBookDetails(book);
    });
    
    actionsDiv.appendChild(viewBtn);
    actionsDiv.appendChild(borrowBtn);
    
    // Append elements to card content
    cardContent.appendChild(title);
    cardContent.appendChild(author);
    cardContent.appendChild(category);
    cardContent.appendChild(status);
    cardContent.appendChild(actionsDiv);
    
    // Append to card
    card.appendChild(coverImg);
    card.appendChild(cardContent);
    
    // Add hover effects
    card.addEventListener('mouseenter', () => {
        card.style.transform = 'translateY(-2px)';
        card.style.boxShadow = '0 4px 8px rgba(0,0,0,0.15)';
    });
    
    card.addEventListener('mouseleave', () => {
        card.style.transform = 'translateY(0)';
        card.style.boxShadow = '0 2px 4px rgba(0,0,0,0.1)';
    });
    
    return card;
}

// Borrow book functionality
function borrowBook(bookId) {
    // Find the book
    const book = books.find(book => book.id === bookId);
    
    if (!book) {
        showToast('Book not found!', 'error');
        return;
    }
    
    if (book.status === 'borrowed') {
        showToast('This book is already borrowed', 'error');
        return;
    }
    
    // Update book status in our local data
    book.status = 'borrowed';
    book.borrowDate = new Date().toISOString();
    
    // Get current borrowed books from localStorage
    const borrowedBooks = JSON.parse(localStorage.getItem('borrowedBooks')) || [];
    
    // Add this book to borrowed books
    const borrowedBook = {
        id: book.id,
        title: book.title,
        author: book.author,
        category: book.category,
        coverUrl: book.coverUrl,
        borrowDate: book.borrowDate,
        returnDate: null,
        status: 'borrowed'
    };
    
    borrowedBooks.push(borrowedBook);
    
    // Save to localStorage
    localStorage.setItem('borrowedBooks', JSON.stringify(borrowedBooks));
    
    // Update total borrowed count
    const totalBorrowed = parseInt(localStorage.getItem('totalBorrowed') || '0');
    localStorage.setItem('totalBorrowed', totalBorrowed + 1);
    
    // Refresh displays
    displayFeaturedBooks();
    calculateStatistics();
    showLibraryStatistics();
    
    // If search results are showing, refresh them too
    const searchResultsSection = document.getElementById('search-results-section');
    if (searchResultsSection && searchResultsSection.style.display !== 'none') {
        const searchInput = document.getElementById('search-input');
        if (searchInput && searchInput.value.trim()) {
            performSearch();
        }
    }
    
    // Show success message
    showToast(`Successfully borrowed "${book.title}"`, 'success');
}

// View book details
function viewBookDetails(book) {
    // Create modal if it doesn't exist
    let modal = document.getElementById('book-details-modal');
    if (!modal) {
        modal = createBookDetailsModal();
    }
    
    // Update modal content
    const modalTitle = modal.querySelector('#book-details-title');
    const modalContent = modal.querySelector('#book-details-content');
    
    modalTitle.textContent = book.title;
    
    const formattedDate = new Date(book.publicationDate).toLocaleDateString('en-US', {
        year: 'numeric', 
        month: 'long', 
        day: 'numeric'
    });
    
    modalContent.innerHTML = `
        <div style="display: flex; gap: 20px; margin-bottom: 20px;">
            <img src="${book.coverUrl || '/api/placeholder/200/250'}" alt="${book.title} cover" 
                 style="width: 150px; height: 200px; object-fit: cover; border-radius: 8px;">
            <div style="flex: 1;">
                <h3 style="margin: 0 0 10px 0; color: #2d3748;">${book.title}</h3>
                <p style="margin: 5px 0;"><strong>Author:</strong> ${book.author}</p>
                <p style="margin: 5px 0;"><strong>ISBN:</strong> ${book.isbn}</p>
                <p style="margin: 5px 0;"><strong>Category:</strong> ${book.category.charAt(0).toUpperCase() + book.category.slice(1)}</p>
                <p style="margin: 5px 0;"><strong>Publication Date:</strong> ${formattedDate}</p>
                <p style="margin: 5px 0;"><strong>Status:</strong> 
                    <span style="color: ${book.status === 'available' ? '#48bb78' : '#ed8936'}; font-weight: 600;">
                        ${book.status.charAt(0).toUpperCase() + book.status.slice(1)}
                    </span>
                </p>
            </div>
        </div>
        <div>
            <p style="margin: 10px 0 5px 0;"><strong>Description:</strong></p>
            <p style="line-height: 1.6; color: #4a5568;">${book.description || 'No description available.'}</p>
        </div>
        ${book.status === 'available' ? 
            `<button onclick="borrowBook(${book.id}); closeBookDetailsModal();" 
                     style="margin-top: 20px; padding: 10px 20px; background: #48bb78; color: white; border: none; border-radius: 4px; cursor: pointer;">
                Borrow This Book
             </button>` : 
            `<p style="margin-top: 20px; color: #ed8936; font-weight: 600;">This book is currently borrowed</p>`}
    `;
    
    // Show modal
    modal.style.display = 'flex';
}

// Create book details modal
function createBookDetailsModal() {
    const modal = document.createElement('div');
    modal.id = 'book-details-modal';
    modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
    `;
    
    const modalContent = document.createElement('div');
    modalContent.style.cssText = `
        background: white;
        border-radius: 8px;
        padding: 20px;
        max-width: 600px;
        max-height: 80vh;
        overflow-y: auto;
        margin: 20px;
        position: relative;
    `;
    
    const closeBtn = document.createElement('button');
    closeBtn.innerHTML = '&times;';
    closeBtn.style.cssText = `
        position: absolute;
        top: 10px;
        right: 15px;
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #718096;
    `;
    closeBtn.onclick = () => modal.style.display = 'none';
    
    const title = document.createElement('h2');
    title.id = 'book-details-title';
    title.style.cssText = 'margin: 0 0 20px 0; color: #2d3748;';
    
    const content = document.createElement('div');
    content.id = 'book-details-content';
    
    modalContent.appendChild(closeBtn);
    modalContent.appendChild(title);
    modalContent.appendChild(content);
    modal.appendChild(modalContent);
    
    // Close on outside click
    modal.addEventListener('click', (e) => {
        if (e.target === modal) {
            modal.style.display = 'none';
        }
    });
    
    document.body.appendChild(modal);
    return modal;
}

// Close book details modal (global function)
function closeBookDetailsModal() {
    const modal = document.getElementById('book-details-modal');
    if (modal) {
        modal.style.display = 'none';
    }
}

// Create and display library statistics
function showLibraryStatistics() {
    // Check if stats section exists
    const statsSection = document.querySelector('.library-stats');
    if (!statsSection) {
        // Create stats section if it doesn't exist
        createStatsSection();
    } else {
        // Update existing section
        updateStatsSection();
    }
}

// Create statistics section
function createStatsSection() {
    console.log('Creating statistics section');
    
    // Create statistics section
    const main = document.querySelector('main');
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'library-stats';
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Library Statistics';
    container.appendChild(heading);
    
    // Create stats grid
    const statsGrid = document.createElement('div');
    statsGrid.className = 'stats-grid';
    statsGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Add stats cards
    statsGrid.appendChild(createStatCard('Total Books', statistics.totalBooks, '📚'));
    statsGrid.appendChild(createStatCard('Available Books', statistics.availableBooks, '✅'));
    statsGrid.appendChild(createStatCard('Borrowed Books', statistics.borrowedBooks, '📖'));
    statsGrid.appendChild(createStatCard('Categories', Object.keys(statistics.categories).length, '🏷️'));
    
    // Append elements
    container.appendChild(statsGrid);
    section.appendChild(container);
    
    // Insert at appropriate position
    // Find search results section or featured books section
    const searchResultsSection = document.getElementById('search-results-section');
    const featuredBooks = document.querySelector('.featured-books');
    
    if (searchResultsSection) {
        main.insertBefore(section, searchResultsSection);
    } else if (featuredBooks) {
        main.insertBefore(section, featuredBooks);
    } else {
        // Insert before quick links as fallback
        const quickLinks = document.querySelector('.quick-links');
        if (quickLinks) {
            main.insertBefore(section, quickLinks);
        } else {
            main.appendChild(section);
        }
    }
}

// Update statistics section
function updateStatsSection() {
    // Get stats cards
    const statsCards = document.querySelectorAll('.stat-card');
    if (!statsCards || statsCards.length < 4) return;
    
    // Update stats values
    statsCards[0].querySelector('.stat-value').textContent = statistics.totalBooks;
    statsCards[1].querySelector('.stat-value').textContent = statistics.availableBooks;
    statsCards[2].querySelector('.stat-value').textContent = statistics.borrowedBooks;
    statsCards[3].querySelector('.stat-value').textContent = Object.keys(statistics.categories).length;
}

// Create statistic card element
function createStatCard(label, value, icon) {
    // Create stat card
    const card = document.createElement('div');
    card.className = 'stat-card';
    card.style.cssText = `
        background: white;
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    `;
    
    // Create card content
    const iconElem = document.createElement('div');
    iconElem.className = 'stat-icon';
    iconElem.textContent = icon;
    iconElem.style.cssText = 'font-size: 24px; margin-bottom: 10px;';
    
    const valueElem = document.createElement('div');
    valueElem.className = 'stat-value';
    valueElem.textContent = value;
    valueElem.style.cssText = 'font-size: 32px; font-weight: bold; color: #2d3748; margin-bottom: 5px;';
    
    const labelElem = document.createElement('div');
    labelElem.className = 'stat-label';
    labelElem.textContent = label;
    labelElem.style.cssText = 'color: #718096; font-size: 14px;';
    
    // Append elements to card
    card.appendChild(iconElem);
    card.appendChild(valueElem);
    card.appendChild(labelElem);
    
    return card;
}

// Perform search functionality
function performSearch() {
    console.log('Performing search');
    
    const searchInput = document.getElementById('search-input');
    if (!searchInput) {
        console.error('Search input not found');
        return;
    }
    
    const searchTerm = searchInput.value.trim().toLowerCase();
    console.log('Search term:', searchTerm);
    
    if (!searchTerm) {
        console.log('Empty search term');
        showToast('Please enter a search term', 'warning');
        return;
    }
    
    // Filter books based on search term
    filteredBooks = books.filter(book => {
        return book.title.toLowerCase().includes(searchTerm) || 
               book.author.toLowerCase().includes(searchTerm) ||
               (book.isbn && book.isbn.includes(searchTerm)) ||
               (book.description && book.description.toLowerCase().includes(searchTerm)) ||
               (book.category && book.category.toLowerCase().includes(searchTerm));
    });
    
    console.log('Found', filteredBooks.length, 'matching books');
    
    // Display search results
    displaySearchResults(searchTerm, filteredBooks);
}

// Display search results
function displaySearchResults(searchTerm, results) {
    console.log('Displaying search results');
    
    // Get search results section and grid
    const searchResultsSection = document.getElementById('search-results-section');
    const searchResultsGrid = document.getElementById('search-results-grid');
    const searchResultsHeading = document.getElementById('search-results-heading');
    
    if (!searchResultsSection || !searchResultsGrid || !searchResultsHeading) {
        console.error('Search results elements not found');
        createSearchResultsSection();
        return displaySearchResults(searchTerm, results); // Try again after creating
    }
    
    // Update heading
    searchResultsHeading.textContent = `Search Results for "${searchTerm}" (${results.length} found)`;
    
    // Clear existing results
    searchResultsGrid.innerHTML = '';
    
    if (results.length === 0) {
        // No results found
        const noResults = document.createElement('div');
        noResults.className = 'no-results';
        noResults.textContent = `No books found matching "${searchTerm}". Try another search term.`;
        noResults.style.cssText = `
            text-align: center;
            padding: 40px;
            color: #718096;
            font-size: 16px;
            background: #f7fafc;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
        `;
        searchResultsGrid.appendChild(noResults);
    } else {
        // Add results to grid
        results.forEach(book => {
            searchResultsGrid.appendChild(createBookCard(book));
        });
    }
    
    // Show search results section
    searchResultsSection.style.display = 'block';
    
    // Scroll to search results
    searchResultsSection.scrollIntoView({ behavior: 'smooth' });
    
    // Hide featured books section if we have search results
    const featuredBooksSection = document.querySelector('.featured-books');
    if (featuredBooksSection) {
        featuredBooksSection.style.display = results.length > 0 ? 'none' : 'block';
    }
}

// Show error message to user
function showErrorMessage(message) {
    console.error(message);
    showToast(message, 'error');
}

// Helper function to show toast notification
function showToast(message, type = 'info') {
    console.log('Showing toast:', message, type);
    
    // Create toast container if it doesn't exist
    let toastContainer = document.getElementById('toast-container');
    if (!toastContainer) {
        toastContainer = document.createElement('div');
        toastContainer.id = 'toast-container';
        toastContainer.className = 'toast-container';
        toastContainer.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
        `;
        document.body.appendChild(toastContainer);
    }
    // Create toast element
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    
    // Set toast styles based on type
    const typeColors = {
        success: { bg: '#48bb78', border: '#38a169' },
        error: { bg: '#f56565', border: '#e53e3e' },
        warning: { bg: '#ed8936', border: '#dd6b20' },
        info: { bg: '#4299e1', border: '#3182ce' }
    };
    
    const colors = typeColors[type] || typeColors.info;
    
    toast.style.cssText = `
        background: ${colors.bg};
        color: white;
        padding: 12px 16px;
        border-radius: 4px;
        border-left: 4px solid ${colors.border};
        margin-bottom: 10px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        opacity: 0;
        transform: translateX(100%);
        transition: all 0.3s ease;
        font-size: 14px;
        max-width: 300px;
        word-wrap: break-word;
    `;
    
    toast.textContent = message;
    
    // Add toast to container
    toastContainer.appendChild(toast);
    
    // Animate in
    setTimeout(() => {
        toast.style.opacity = '1';
        toast.style.transform = 'translateX(0)';
    }, 10);
    
    // Auto remove after 5 seconds
    setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transform = 'translateX(100%)';
        setTimeout(() => {
            if (toast.parentNode) {
                toast.parentNode.removeChild(toast);
            }
        }, 300);
    }, 5000);
}

// Reset search - show all books again
function resetSearch() {
    console.log('Resetting search');
    
    // Clear search input
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.value = '';
    }
    
    // Hide search results section
    const searchResultsSection = document.getElementById('search-results-section');
    if (searchResultsSection) {
        searchResultsSection.style.display = 'none';
    }
    
    // Show featured books section
    const featuredBooksSection = document.querySelector('.featured-books');
    if (featuredBooksSection) {
        featuredBooksSection.style.display = 'block';
    }
    
    // Reset filtered books to all books
    filteredBooks = [...books];
}

// Filter books by category
function filterByCategory(category) {
    console.log('Filtering by category:', category);
    
    if (!category || category === 'all') {
        // Show all books
        filteredBooks = [...books];
        displaySearchResults('All Categories', filteredBooks);
    } else {
        // Filter by specific category
        filteredBooks = books.filter(book => 
            book.category && book.category.toLowerCase() === category.toLowerCase()
        );
        displaySearchResults(`Category: ${category.charAt(0).toUpperCase() + category.slice(1)}`, filteredBooks);
    }
}

// Sort books by various criteria
function sortBooks(criteria) {
    console.log('Sorting books by:', criteria);
    
    let sortedBooks = [...filteredBooks];
    
    switch (criteria) {
        case 'title':
            sortedBooks.sort((a, b) => a.title.localeCompare(b.title));
            break;
        case 'author':
            sortedBooks.sort((a, b) => a.author.localeCompare(b.author));
            break;
        case 'category':
            sortedBooks.sort((a, b) => (a.category || '').localeCompare(b.category || ''));
            break;
        case 'date':
            sortedBooks.sort((a, b) => new Date(b.publicationDate) - new Date(a.publicationDate));
            break;
        case 'availability':
            sortedBooks.sort((a, b) => {
                if (a.status === 'available' && b.status !== 'available') return -1;
                if (a.status !== 'available' && b.status === 'available') return 1;
                return 0;
            });
            break;
        default:
            console.warn('Unknown sort criteria:', criteria);
            return;
    }
    
    filteredBooks = sortedBooks;
    
    // Re-display current results with sorted order
    const searchInput = document.getElementById('search-input');
    const currentSearchTerm = searchInput ? searchInput.value.trim() : '';
    
    if (currentSearchTerm) {
        displaySearchResults(`"${currentSearchTerm}" (sorted by ${criteria})`, filteredBooks);
    } else {
        displaySearchResults(`All Books (sorted by ${criteria})`, filteredBooks);
    }
}

// Get book recommendations (similar books)
function getRecommendations(bookId, limit = 4) {
    const book = books.find(b => b.id === bookId);
    if (!book) return [];
    
    // Find books with same category or author
    const recommendations = books.filter(b => 
        b.id !== bookId && 
        (b.category === book.category || b.author === book.author) &&
        b.status === 'available'
    );
    
    // Sort by relevance (category match first, then author match)
    recommendations.sort((a, b) => {
        const aScore = (a.category === book.category ? 2 : 0) + (a.author === book.author ? 1 : 0);
        const bScore = (b.category === book.category ? 2 : 0) + (b.author === book.author ? 1 : 0);
        return bScore - aScore;
    });
    
    return recommendations.slice(0, limit);
}

// Export data functionality
function exportLibraryData(format = 'json') {
    console.log('Exporting library data as:', format);
    
    try {
        let data;
        let filename;
        let mimeType;
        
        if (format === 'json') {
            data = JSON.stringify({
                books,
                statistics,
                exportDate: new Date().toISOString()
            }, null, 2);
            filename = `library-data-${new Date().toISOString().split('T')[0]}.json`;
            mimeType = 'application/json';
        } else if (format === 'csv') {
            // Convert to CSV format
            const headers = ['ID', 'Title', 'Author', 'ISBN', 'Category', 'Status', 'Publication Date', 'Description'];
            const csvRows = [headers.join(',')];
            
            books.forEach(book => {
                const row = [
                    book.id,
                    `"${book.title}"`,
                    `"${book.author}"`,
                    book.isbn || '',
                    book.category || '',
                    book.status || 'available',
                    book.publicationDate || '',
                    `"${(book.description || '').replace(/"/g, '""')}"`
                ];
                csvRows.push(row.join(','));
            });
            
            data = csvRows.join('\n');
            filename = `library-data-${new Date().toISOString().split('T')[0]}.csv`;
            mimeType = 'text/csv';
        } else {
            throw new Error('Unsupported export format');
        }
        
        // Create download link
        const blob = new Blob([data], { type: mimeType });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        showToast(`Library data exported as ${filename}`, 'success');
    } catch (error) {
        console.error('Export failed:', error);
        showToast('Failed to export library data', 'error');
    }
}

// Import data functionality (placeholder for future implementation)
function importLibraryData(file) {
    console.log('Import functionality not yet implemented');
    showToast('Import functionality coming soon!', 'info');
}

// Advanced search functionality
function advancedSearch(criteria) {
    console.log('Performing advanced search with criteria:', criteria);
    
    let results = [...books];
    
    // Apply filters
    if (criteria.title) {
        results = results.filter(book => 
            book.title.toLowerCase().includes(criteria.title.toLowerCase())
        );
    }
    
    if (criteria.author) {
        results = results.filter(book => 
            book.author.toLowerCase().includes(criteria.author.toLowerCase())
        );
    }
    
    if (criteria.category && criteria.category !== 'all') {
        results = results.filter(book => 
            book.category && book.category.toLowerCase() === criteria.category.toLowerCase()
        );
    }
    
    if (criteria.status && criteria.status !== 'all') {
        results = results.filter(book => 
            book.status === criteria.status
        );
    }
    
    if (criteria.yearFrom) {
        results = results.filter(book => {
            const bookYear = new Date(book.publicationDate).getFullYear();
            return bookYear >= parseInt(criteria.yearFrom);
        });
    }
    
    if (criteria.yearTo) {
        results = results.filter(book => {
            const bookYear = new Date(book.publicationDate).getFullYear();
            return bookYear <= parseInt(criteria.yearTo);
        });
    }
    
    filteredBooks = results;
    displaySearchResults('Advanced Search Results', results);
}

// Utility function to debounce search
function debounce(func, wait) {
    let timeout;
    return function executedFunction(...args) {
        const later = () => {
            clearTimeout(timeout);
            func(...args);
        };
        clearTimeout(timeout);
        timeout = setTimeout(later, wait);
    };
}

// Create debounced search function
const debouncedSearch = debounce(performSearch, 300);

// Function to setup live search (if needed)
function setupLiveSearch() {
    const searchInput = document.getElementById('search-input');
    if (searchInput) {
        searchInput.addEventListener('input', debouncedSearch);
    }
}

// Validate book data
function validateBookData(book) {
    const required = ['id', 'title', 'author'];
    const missing = required.filter(field => !book[field]);
    
    if (missing.length > 0) {
        console.warn('Book missing required fields:', missing, book);
        return false;
    }
    
    return true;
}

// Format date for display
function formatDate(dateString) {
    if (!dateString) return 'Unknown';
    
    try {
        const date = new Date(dateString);
        return date.toLocaleDateString('en-US', {
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });
    } catch (error) {
        console.warn('Invalid date format:', dateString);
        return 'Invalid Date';
    }
}

// Get available categories
function getAvailableCategories() {
    const categories = new Set();
    books.forEach(book => {
        if (book.category) {
            categories.add(book.category);
        }
    });
    return Array.from(categories).sort();
}

// Clear all filters and search
function clearAllFilters() {
    resetSearch();
    showToast('All filters cleared', 'info');
}

// Initialize tooltips or help text
function initializeHelpers() {
    // Add any helper initialization here
    console.log('Helpers initialized');
}

// Error handling for missing images
function handleImageError(img) {
    img.src = '/api/placeholder/250/300';
    img.alt = 'Book cover not available';
}

// Check if localStorage is available
function isStorageAvailable() {
    try {
        const test = '__storage_test__';
        localStorage.setItem(test, test);
        localStorage.removeItem(test);
        return true;
    } catch (e) {
        console.warn('localStorage not available');
        return false;
    }
}

// Cleanup function for memory management
function cleanup() {
    // Remove event listeners if needed
    // Clear intervals/timeouts
    console.log('Cleanup performed');
}

// Initialize additional features when DOM is ready
document.addEventListener('DOMContentLoaded', () => {
    // Initialize helpers
    initializeHelpers();
    
    // Setup additional event listeners
    window.addEventListener('beforeunload', cleanup);
});

// Make some functions globally available
window.borrowBook = borrowBook;
window.viewBookDetails = viewBookDetails;
window.closeBookDetailsModal = closeBookDetailsModal;
window.resetSearch = resetSearch;
window.filterByCategory = filterByCategory;
window.sortBooks = sortBooks;
window.exportLibraryData = exportLibraryData;






// Create search results section - FIXED POSITIONING
function createSearchResultsSection() {
    console.log('Creating search results section');
    
    // Get main element
    const main = document.querySelector('main');
    const footer = document.querySelector('footer');
    
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'search-results-section';
    section.id = 'search-results-section';
    section.style.display = 'none'; // Hide initially
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Search Results';
    heading.id = 'search-results-heading';
    container.appendChild(heading);
    
    // Create books grid for search results
    const booksGrid = document.createElement('div');
    booksGrid.className = 'books-grid';
    booksGrid.id = 'search-results-grid';
    booksGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Append elements
    container.appendChild(booksGrid);
    section.appendChild(container);
    
    // Insert BEFORE footer, not after other sections
    if (footer) {
        footer.parentNode.insertBefore(section, footer);
    } else {
        // Fallback: append to main
        main.appendChild(section);
    }
}

// Create statistics section - FIXED POSITIONING
function createStatsSection() {
    console.log('Creating statistics section');
    
    // Create statistics section
    const main = document.querySelector('main');
    const footer = document.querySelector('footer');
    
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'library-stats';
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Library Statistics';
    container.appendChild(heading);
    
    // Create stats grid
    const statsGrid = document.createElement('div');
    statsGrid.className = 'stats-grid';
    statsGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Add stats cards
    statsGrid.appendChild(createStatCard('Total Books', statistics.totalBooks, '📚'));
    statsGrid.appendChild(createStatCard('Available Books', statistics.availableBooks, '✅'));
    statsGrid.appendChild(createStatCard('Borrowed Books', statistics.borrowedBooks, '📖'));
    statsGrid.appendChild(createStatCard('Categories', Object.keys(statistics.categories).length, '🏷️'));
    
    // Append elements
    container.appendChild(statsGrid);
    section.appendChild(container);
    
    // Insert BEFORE footer
    if (footer) {
        footer.parentNode.insertBefore(section, footer);
    } else {
        // Fallback: append to main
        main.appendChild(section);
    }
}

// Create featured books section - FIXED POSITIONING  
function createFeaturedBooksSection() {
    console.log('Creating featured books section');
    
    // Create featured books section
    const main = document.querySelector('main');
    const footer = document.querySelector('footer');
    
    if (!main) return;
    
    // Create section element
    const section = document.createElement('section');
    section.className = 'featured-books';
    
    // Create section content
    const container = document.createElement('div');
    container.className = 'container';
    
    // Add heading
    const heading = document.createElement('h2');
    heading.textContent = 'Featured Books';
    container.appendChild(heading);
    
    // Create books grid
    const booksGrid = document.createElement('div');
    booksGrid.className = 'books-grid';
    booksGrid.id = 'featured-books-grid';
    booksGrid.style.cssText = `
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-top: 20px;
    `;
    
    // Add featured books
    const featuredBooks = getFeaturedBooks();
    featuredBooks.forEach(book => {
        booksGrid.appendChild(createBookCard(book));
    });
    
    // Append elements
    container.appendChild(booksGrid);
    section.appendChild(container);
    
    // Insert BEFORE footer
    if (footer) {
        footer.parentNode.insertBefore(section, footer);
    } else {
        // Fallback: append to main
        main.appendChild(section);
    }
}








// // Intersection Observer for scroll animations
//         const observerOptions = {
//             threshold: 0.1,
//             rootMargin: '0px 0px -50px 0px'
//         };

//         const observer = new IntersectionObserver((entries) => {
//             entries.forEach(entry => {
//                 if (entry.isIntersecting) {
//                     entry.target.classList.add('visible');
//                 }
//             });
//         }, observerOptions);

//         // Observe all sections
//         document.querySelectorAll('.section').forEach(section => {
//             observer.observe(section);
//         });

//         // Counter animation for statistics
//         function animateCounter(element, target) {
//             let current = 0;
//             const increment = target / 100;
//             const timer = setInterval(() => {
//                 current += increment;
//                 if (current >= target) {
//                     element.textContent = target.toLocaleString();
//                     clearInterval(timer);
//                 } else {
//                     element.textContent = Math.floor(current).toLocaleString();
//                 }
//             }, 20);
//         }

//         // Trigger counter animations when stats section is visible
//         const statsObserver = new IntersectionObserver((entries) => {
//             entries.forEach(entry => {
//                 if (entry.isIntersecting) {
//                     const counters = entry.target.querySelectorAll('.stat-number');
//                     counters.forEach(counter => {
//                         const target = parseInt(counter.getAttribute('data-target'));
//                         animateCounter(counter, target);
//                     });
//                     statsObserver.unobserve(entry.target);
//                 }
//             });
//         }, { threshold: 0.5 });

//         const statsSection = document.querySelector('.stats-section');
//         if (statsSection) {
//             statsObserver.observe(statsSection);
//         }

//         // Interactive feature cards
//         document.querySelectorAll('.feature-card').forEach(card => {
//             card.addEventListener('mouseenter', function() {
//                 this.style.transform = 'translateY(-15px) scale(1.02)';
//             });
            
//             card.addEventListener('mouseleave', function() {
//                 this.style.transform = 'translateY(0) scale(1)';
//             });
//         });

//         // Button interactions
//         function showDemo() {
//             alert('Demo request submitted! We\'ll contact you soon to schedule a personalized demonstration of our Library Management System.');
//         }

//         function showContact() {
//             alert('Thank you for your interest! Please reach out to us using the contact information provided above.');
//         }

//         // Smooth scrolling for internal links
//         document.querySelectorAll('a[href^="#"]').forEach(anchor => {
//             anchor.addEventListener('click', function (e) {
//                 e.preventDefault();
//                 const target = document.querySelector(this.getAttribute('href'));
//                 if (target) {
//                     target.scrollIntoView({
//                         behavior: 'smooth',
//                         block: 'start'
//                     });
//                 }
//             });
//         });

//         // Dynamic background shapes movement
//         function moveShapes() {
//             const shapes = document.querySelectorAll('.shape');
//             shapes.forEach((shape, index) => {
//                 const x = Math.sin(Date.now() * 0.001 + index) * 20;
//                 const y = Math.cos(Date.now() * 0.001 + index) * 15;
//                 shape.style.transform = `translate(${x}px, ${y}px)`;
//             });
//             requestAnimationFrame(moveShapes);
//         }
//         moveShapes();

//         // Add loading animation
//         window.addEventListener('load', function() {
//             document.body.style.opacity = '0';
//             document.body.style.transition = 'opacity 0.5s ease-in-out';
//             setTimeout(() => {
//                 document.body.style.opacity = '1';
//             }, 100);
//         });

//         // Parallax effect for header
//         window.addEventListener('scroll', function() {
//             const scrolled = window.pageYOffset;
//             const header = document.querySelector('.header');
//             if (header) {
//                 header.style.transform = `translateY(${scrolled * 0.5}px)`;
//             }
//         });
</script>
<!--script src="search.js"></script-->
</body>
</html>

